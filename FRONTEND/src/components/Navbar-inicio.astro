---
  import Index from "../pages/index.astro";
---




<nav class="bg-white border-gray-200 dark:bg-gray-900">
    <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
    <a href="https://flowbite.com/" class="flex items-center space-x-3 rtl:space-x-reverse">
        <img src="/img/logo.png" class="h-8 rounded-full " alt="Mapache Logo" />
        <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">Edu Web</span>
    </a>

   
    <div class="flex items-center md:order-2 space-x-3 md:space-x-0 rtl:space-x-reverse">

<!-- Modal toggle -->
<button data-modal-target="authentication-modal" data-modal-toggle="authentication-modal" class="relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-purple-600 to-blue-500 group-hover:from-purple-600 group-hover:to-blue-500 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800" type="button">
  <span class="relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0">
    Conoce más!
    </span>  
  </button>
  
  
  <!-- Main modal -->
  <div id="authentication-modal" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
      <div class="relative p-4 w-full max-w-md max-h-full">
          <!-- Modal content -->
          <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
              <!-- Modal header -->
              <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                  <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                    Inicia sesión en nuestra plataforma
                  </h3>
                  <button type="button" class="end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="authentication-modal">
                      <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                      </svg>
                      <span class="sr-only">Close modal</span>
                  </button>
              </div>
              <!-- Modal body -->
              <div class="p-4 md:p-5">
                  <form id="login-form" class="space-y-4">
                      <div>
                          <label for="email" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"></label>
                          <input type="email" name="email" id="email" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" placeholder="your_email@company.com" required />
                      </div>
                      <div>
                          <label for="password" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"></label>
                          <input type="password" name="password" id="password" placeholder="Contraseña" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                      </div>
                      <div class="flex justify-between">
                          <div class="flex items-start">
                              <div class="flex items-center h-5">
                                  <input id="remember" type="checkbox" value="" class="w-4 h-4 border border-gray-300 rounded bg-gray-50 focus:ring-3 focus:ring-blue-300 dark:bg-gray-600 dark:border-gray-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800" required />
                              </div>
                              <label for="remember" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Recuerdame </label>
                          </div>
                          <a href="#" class="text-sm text-blue-700 hover:underline dark:text-blue-500">Olvidaste tu contraseña?</a>
                      </div>
                      <button type="submit" class="w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Inicia sesión</button>
                      <!-- <div class="text-sm font-medium text-gray-500 dark:text-gray-300">
                          Not registered? <a href="#" class="text-blue-700 hover:underline dark:text-blue-500">Creat account</a>
                      </div> -->
                  </form>
              </div>
          </div>
      </div>
  </div> 
  

    </div>
    <div class="items-center justify-between hidden w-full md:flex md:w-auto md:order-1" id="navbar-user">
      <ul class="flex flex-col font-medium p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50 md:space-x-8 rtl:space-x-reverse md:flex-row md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
        <li>
          <a class="block py-2 px-3 text-white bg-blue-700 rounded md:bg-transparent md:text-blue-700 md:p-0 md:dark:text-blue-500" aria-current="page">Clientes</a>
        </li>
        <li>
          <!--SALTO A SECTION -->
          <a  href="#ultimosTrabajos" name="ultimosTrabajos" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Últimos Trábajos</a>
        </li>
        <li>
          <a href="#" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Servicios</a>
        </li>
        <li>
          <a href="#" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Nosotros</a>
        </li>
        <li>
          <a href="#" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Contáctanos</a>
        </li>
      </ul>
    </div>
    </div>


  </nav>

  <style>
    /* Ocultar barras de desplazamiento en navegadores webkit */
    ::-webkit-scrollbar {
      width: 0;
      height: 0;
    }
    /* Asegurarse de que el contenido sea desplazable aunque las barras de desplazamiento estén ocultas */
    html, body {
      overflow: -moz-scrollbars-none;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  </style>
  
  <script>
    import { Modal } from 'flowbite';
    import type { ModalOptions, ModalInterface } from 'flowbite';
    import type { InstanceOptions } from 'flowbite';

    const $modalElement: HTMLElement = document.querySelector('#modalEl');

    const modalOptions: ModalOptions = {
        placement: 'bottom-right',
        backdrop: 'dynamic',
        backdropClasses:
            'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',
        closable: true,
        onHide: () => {
            console.log('modal is hidden');
        },
        onShow: () => {
            console.log('modal is shown');
        },
        onToggle: () => {
            console.log('modal has been toggled');
        },
    };

    // instance options object
    const instanceOptions: InstanceOptions = {
    id: 'modalEl',
    override: true
    };

    const modal: ModalInterface = new Modal($modalElement, modalOptions, instanceOptions);

    modal.show();
  </script>

<!-- 
<script>
  document.getElementById('login-form').addEventListener('submit', function(event) {
    event.preventDefault();
    
 // Aserción de tipo para decirle a TypeScript que estos elementos son HTMLInputElement
    const email = (document.getElementById('email') as HTMLInputElement).value;
    const password = (document.getElementById('password') as HTMLInputElement).value;

    // Fetching users from the JSON file
    fetch('/data/user.json')
      .then(response => response.json())
      .then(users => {
        const user = users.find(user => user.email === email && user.clave === password);
        
        if (user) {
          // Guardar solo el ID del usuario en localStorage
          localStorage.setItem('userId', user.id);

          // Redirigir según el rol del usuario
          switch (user.rol) {
            case 'alumno':
              window.location.href = '/dashboard/alumno';
              break;
            case 'profesor':
              window.location.href = '/dashboard/profesor';
              break;
            case 'tutor':
              window.location.href = '/dashboard/tutor';
              break;
            case 'administrativo':
              window.location.href = '/dashboard/administrativo';
              break;
            default:
              alert('Rol no reconocido');
          }
        } else {
          alert('Credenciales incorrectas');
        }
      })
      .catch(error => {
        console.error('Error fetching users:', error);
        alert('Ocurrió un error al intentar iniciar sesión. Por favor, intenta de nuevo más tarde.');
      });
  });
</script> -->


<script>
  document.getElementById('login-form').addEventListener('submit', function(event) {
    event.preventDefault();
    
    // const email = document.getElementById('email').value;
    // const password = document.getElementById('password').value;

    const email = (document.getElementById('email') as HTMLInputElement).value;
    const password = (document.getElementById('password') as HTMLInputElement).value;

    // Fetching users from the JSON file
    fetch('/data/alumno.json')
      .then(response => response.json())
      .then(users => {
        const user = users.find(user => user.auth.email === email && user.auth.password === password);
        
        if (user) {
          // Guardar solo el ID del usuario en localStorage
          localStorage.setItem('userId', user.id);

          // Redirigir según el rol del usuario
          switch (user.auth.rol) {
            case 'alumno':
              window.location.href = `/notas?id=${user.id}`;
              break;
            // Agregar otros casos según los roles necesarios
            default:
              alert('Rol no reconocido');
          }
        } else {
          alert('Credenciales incorrectas');
        }
      })
      .catch(error => {
        console.error('Error fetching users:', error);
        alert('Ocurrió un error al intentar iniciar sesión. Por favor, intenta de nuevo más tarde.');
      });
  });
</script>